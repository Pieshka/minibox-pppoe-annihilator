#!/bin/sh

DAEMON="acpid"

EXEC="/usr/sbin/$DAEMON"
PIDFILE="/var/run/$DAEMON.pid"

ACPID_ARGS="-c /etc/acpi"

start() {
    printf 'Starting %s: ' "$DAEMON"

    # shellcheck disable=SC2086 # we need the word splitting
    start-stop-daemon -S -q -p "$PIDFILE" -x "$EXEC" \
        -- $ACPID_ARGS
    status=$?
    if [ "$status" -eq 0 ]; then
        echo "OK"
    else
        echo "FAIL"
    fi

    return $status
}

stop() {
    printf 'Stopping %s: ' "$DAEMON"

    start-stop-daemon -p "$PIDFILE" -q -K 
    status=$?
    if [ "$status" -eq 0 ]; then
        echo "OK"
    else
        echo "FAIL"
    fi

    return $status
}

restart() {
    stop
    start
}

case "$1" in
    start|stop|restart)
        "$1";;
    reload)
        restart;;
    *)
        echo "Usage: $0 {start|stop|restart|reload}"
        exit 1
esac